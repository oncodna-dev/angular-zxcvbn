(function(){'use strict';angular.module('zxcvbn',[]).directive('zxcvbn',function(){return{scope:{password:'=',extras:'=?',data:'=?'},restrict:'E',template:'{{ display.crack_times_display }}',link:function(scope,element,attrs){scope.$watch('password',function(newVal){if(angular.isString(newVal)){if(scope.extras)
scope.timeToCrack=zxcvbn(newVal,scope.extras);else scope.timeToCrack=zxcvbn(newVal);if(('data' in attrs)&&scope.timeToCrack)
scope.data=angular.copy(scope.timeToCrack);scope.display=angular.copy(scope.timeToCrack)}})}}})})();(function(){'use strict';angular.module('zxcvbn').directive('zxcvbn',function(){return{require:'ngModel',restrict:'A',scope:{zxResult:'=?zxcvbn',zxExtras:'=?',zxMinScore:'@?',zxFeedback:'=?'},link:function(scope,element,attrs,ngModelCtrl){scope.runZxcvbn=function(){if(angular.isUndefined(scope.zxPassword)){scope.zxPassword=''}
if(angular.isUndefined(scope.zxFeedback)){scope.zxFeedback={}}
if(angular.isDefined(scope.zxExtrasArray)&&scope.zxExtrasArray.length>0){scope.zxResult=zxcvbn(scope.zxPassword,scope.zxExtrasArray,scope.zxFeedback)}else{scope.zxResult=zxcvbn(scope.zxPassword,[],scope.zxFeedback)}};scope.isForm=function(value){try{return Object.getPrototypeOf(value).constructor.name==='FormController'}catch(error){return!1}};scope.setZxExtrasWatcher=function(){var extras=scope.zxExtras;if(angular.isFunction(scope.zxExtrasWatcher)){scope.zxExtrasWatcher()}
scope.zxExtrasWatcher=undefined;if(angular.isDefined(extras)){if(angular.isArray(extras)){scope.zxArrayWatcher()}else if(scope.isForm(extras)){scope.zxFormWatcher()}}};scope.zxFormWatcher=function(){var form=scope.zxExtras;console.assert(scope.isForm(form),'zx-extras element is some how not a form.');scope.zxExtrasWatcher=scope.$watch(function(){var extrasArray=[];var validPropertyRegex=new RegExp('^(?!\\$|__)');for(var prop in form){if(validPropertyRegex.test(prop)&&form[prop].hasOwnProperty('$viewValue')&&prop.toLowerCase().indexOf('password')===-1){extrasArray.push(form[prop].$viewValue)}}
return extrasArray},function(newValue){scope.zxExtrasArray=[];for(var i=0;i<newValue.length;i++){if(angular.isString(newValue[i])){scope.zxExtrasArray.push(newValue[i])}}
ngModelCtrl.$validate()},!0)};scope.zxArrayWatcher=function(){scope.zxExtrasWatcher=scope.$watch('zxExtras',function(newValue){scope.zxExtrasArray=newValue;ngModelCtrl.$validate()},!0)};scope.setZxExtrasWatcher();ngModelCtrl.$validators.passwordStrength=function(value){var minScore=parseInt(scope.zxMinScore);minScore=(isNaN(minScore)||minScore<0||minScore>4)?0:minScore;scope.zxPassword=value;scope.runZxcvbn();return minScore<=scope.zxResult.score};attrs.$observe('zxExtras',function(){scope.setZxExtrasWatcher();ngModelCtrl.$validate()});attrs.$observe('zxMinScore',function(value){scope.zxMinScore=value;ngModelCtrl.$validate()})}}})})()
